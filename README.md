# Project
##Repo for Part of Figure 1C from Candy Bian
This script recreates the temperature–trend response curves by combining the main climate–energy dataset with the income breakpoint file. After loading the data, I generate the same variables used in the original Stata workflow, including the year-to-year difference and the two temperature–trend interaction terms. These terms are centered at 20°C and 400 to match how the original model defines the “baseline” temperature around which the trend is measured. I also pull income information from the break-data file so I can identify the income threshold used in the spline and compute the three income tercile averages. These values determine how strongly the income interaction enters the predicted curve for each group.

I fit the regression directly in R using feols so the entire workflow is self-contained. The model includes the linear and squared interactions between temperature and time, plus their interactions with an income dummy. After the regression is estimated, I build a temperature grid from –5°C to 35°C and reconstruct the prediction equation by hand for each value in the grid. This includes calculating standard errors using the model’s variance–covariance matrix. I repeat this process for each of the three income terciles by adjusting the income spline term so that each tercile has its own prediction path.

Once the predicted values and confidence intervals are created, I generate one panel per tercile. Each panel shows the estimated marginal effect of temperature over time, with a shaded confidence band and a zero reference line. Finally, I combine the three plots into a single figure and save it to the figures folder. The final output summarizes how the marginal relationship between temperature and energy use evolves differently across income levels, mirroring the structure of the diagnostics used in the original analysis.
